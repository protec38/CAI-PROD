<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>{{ 'Créer' if mode == 'create' else 'Modifier' }} un utilisateur</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
</head>
<body>
<div class="container">
    <h1>{{ 'Créer' if mode == 'create' else 'Modifier' }} un utilisateur</h1>

    <form method="post">
        <label for="nom">Nom complet</label>
        <input type="text" id="nom" name="nom" required value="{{ utilisateur.nom if utilisateur else '' }}">

        <label for="nom_utilisateur">Nom d’utilisateur</label>
        <input type="text" id="nom_utilisateur" name="nom_utilisateur" required value="{{ utilisateur.nom_utilisateur if utilisateur else '' }}">

        <label for="role">Rôle</label>
        <select id="role" name="role" required>
            <option value="">-- Choisir un rôle --</option>
            <option value="technicien"   {% if utilisateur and utilisateur.role=='technicien' %}selected{% endif %}>Technicien</option>
            <option value="secouriste" {% if utilisateur and utilisateur.role == 'secouriste' %}selected{% endif %}>Secouriste</option>
            <option value="aep" {% if utilisateur and utilisateur.role == 'aep' %}selected{% endif %}>AEP</option>
            <option value="logisticien" {% if utilisateur and utilisateur.role == 'logisticien' %}selected{% endif %}>Logisticien</option>
            <option value="responsable" {% if utilisateur and utilisateur.role == 'responsable' %}selected{% endif %}>Responsable</option>
            <option value="codep" {% if utilisateur and utilisateur.role == 'codep' %}selected{% endif %}>CODEP</option>
        </select>

        <label for="type_utilisateur">Type d'utilisateur</label>
        <select id="type_utilisateur" name="type_utilisateur" required>
            <option value="">-- Choisir un type --</option>
            <option value="permanent" {% if utilisateur and utilisateur.type_utilisateur == 'permanent' %}selected{% endif %}>Permanent</option>
            <option value="provisoire" {% if utilisateur and utilisateur.type_utilisateur == 'provisoire' %}selected{% endif %}>Provisoire</option>
        </select>

        <label for="password">Mot de passe {% if mode == 'edit' %}(laisser vide pour ne pas changer){% endif %}</label>
        <input type="password" id="password" name="password" {% if mode == 'create' %}required{% endif %}>

        <label>Associer aux évènements :</label>
        <div class="event-checkboxes">
            {% for evt in all_evenements %}
                <label>
                    <input type="checkbox" name="evenements" value="{{ evt.id }}"
                           {% if utilisateur and evt in utilisateur.evenements %}checked{% endif %}>
                    {{ evt.nom }} ({{ evt.numero }})
                </label>
            {% endfor %}
        </div>

        <button type="submit">{{ 'Créer' if mode == 'create' else 'Mettre à jour' }}</button>
    </form>

    <a href="{{ url_for('main_bp.admin_utilisateurs') }}" class="btn-back">← Retour à la liste des utilisateurs</a>
</div>
</body>
</html>
